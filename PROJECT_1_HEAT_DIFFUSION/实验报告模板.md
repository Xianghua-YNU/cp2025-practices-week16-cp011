# 项目：铝棒热传导方程显式差分法数值解 - 实验报告

**学生姓名：** [肖澎] 

**学号：** [20231050083] 

**完成日期：** [6.11]

## 1. 实验目的

通过实现显式差分法求解一维热传导方程，掌握偏微分方程数值解法的基本原理，深入理解显式差分法的稳定性条件和精度特点，学会分析数值方法的误差和稳定性。

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学表达式为：

$$\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}$$

其中：
- $T(x,t)$ 是温度分布函数
- $\alpha = \frac{K}{C\rho}$ 是热扩散系数
- $K$ 是热导率， $C$ 是比热容， $\rho$ 是密度

### 2.2 边界条件和初始条件

- **边界条件：** $T(0,t) = T(L,t) = 0$ K（两端保持0度）
- **初始条件：** $T(x,0) = 100$ K（初始温度均匀分布）

### 2.3 解析解

该问题的解析解为傅里叶级数：

$$T(x,t) = \sum_{n=1,3,5,\ldots}^{\infty} \frac{4T_0}{n\pi} \sin(k_n x) e^{-k_n^2 \alpha t}$$

其中 $k_n = \frac{n\pi}{L}$， $T_0 = 100$ K。

## 2. 核心算法

### 2.1 显式差分法算法思路

[显式差分法通过：

离散化空间和时间

用差分近似导数

建立显式迭代格式

在稳定性条件下推进求解

特别适用于抛物型偏微分方程的数值求解，是计算科学中的基础工具。对于需要大时间步长或高精度的问题，可考虑隐式方法（如Crank-Nicolson格式）。

]

### 2.2 关键代码片段
```def basic_heat_diffusion():
    """任务1: 基本热传导模拟"""

    r = D * dt / (dx ** 2)
    print(f"任务1 - 稳定性参数 r = {r}")

    u = np.zeros((Nx, Nt))
    u[:, 0] = 100
    u[0, :] = 0
    u[-1, :] = 0

    for j in range(Nt - 1):
        u[1:-1, j + 1] = (1 - 2 * r) * u[1:-1, j] + r * (u[2:, j] + u[:-2, j])

    return u
```

## 3. 实验结果

### 3.1 显式差分法数值解

[![image](https://github.com/user-attachments/assets/5180fe70-e84f-4592-a7ef-66a8272fe556)
]


### 3.2 解析解
**解析解公式：**

$$T(x,t)=\sum\limits_{n=1,3,\cdots}^{\infty}\frac{4T_0}{n\pi}\sin(k_nx)e^{-k_n^2Dt}$$

其中 $k_n = n\pi/L$， $T_0=100$ K

[展示解析解的温度分布随时间位置演化的3D图![image](https://github.com/user-attachments/assets/46695ce4-e365-412a-a96c-922058cb2caa)
]


### 3.3 稳定性分析

**稳定性条件：** r = DΔt/Δx² ≤ 0.5

分析不同 $r$ 值下的数值解行为，展示稳定和不稳定情况的对比

[不稳定情况的温度分布的3D图![image](https://github.com/user-attachments/assets/9cac6a3a-97d6-49a5-8d61-39e934099d89)
]

[稳定情况的温度分布的3D图![image](https://github.com/user-attachments/assets/e950aef5-959f-472d-8fe1-d716dbe48c1b)
]


### 3.4 不同初始条件模拟

[展示分段初始条件下的温度分布随时间位置演化的3D图![image](https://github.com/user-attachments/assets/f7c9ec1d-e3da-4a5c-bf97-d5eefcf7b548)
]


### 3.5 包含牛顿冷却定律的模拟
[展示包含牛顿冷却定律的温度分布随时间位置演化的3D图]![image](https://github.com/user-attachments/assets/5e70ff91-3a6f-4660-b8ad-a603715129c8

## 4. 分析与讨论

1. **稳定性问题：** [稳定性问题的表现
数值解发散：当时间步长过大时，解会指数级增长，导致计算结果完全不可用
振荡现象：即使未完全发散，也可能出现高频振荡，导致解的物理意义丧失
计算效率低下：为满足稳定性条件，必须使用极小的时间步长，导致计算量剧增
改进方法
使用隐式方法：如 Crank-Nicolson 方法，无条件稳定但计算复杂度增加
空间自适应步长：在解变化剧烈区域使用较小空间步长
混合方法：在不稳定区域使用隐式格式，稳定区域使用显式格式]
2. **精度问题：** [精度问题的表现
截断误差：通常为 O (Δt, (Δx)²)，即时间方向一阶精度，空间方向二阶精度
数值扩散：解的平滑化效应，导致边界和梯度信息丢失
边界条件处理：边界附近精度显著降低
改进方法
高阶差分格式：使用中心差分或迎风差分提高空间精度
Richardson 外推：结合不同步长的计算结果，提高精度
自适应网格：在梯度大的区域细化网格
时间积分改进：使用 Runge-Kutta 等高阶时间积分方法]

## 5. 思考题

### 5.1 理论思考

1. **为什么显式差分法在r > 0.5时会产生数值振荡？**
   [显式差分法数值振荡的数学分析显式差分法在求解热传导方程时出现数值振荡的原因可以通过稳定性分析和特征值理论来解释。让我们以一维热传导方程为例进行详细分析。热传导方程的显式差分格式考虑一维热传导方程：\(\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}\)使用显式差分格式离散化后：\(\frac{u_i^{n+1} - u_i^n}{\Delta t} = \alpha \frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{(\Delta x)^2}\)整理后得到递推公式：\(u_i^{n+1} = r u_{i+1}^n + (1-2r) u_i^n + r u_{i-1}^n\)其中，\(r = \frac{\alpha \Delta t}{(\Delta x)^2}\) 是关键参数。稳定性分析显式差分法的稳定性条件是 \(r \leq 0.5\)。当 \(r > 0.5\) 时，会出现数值振荡，这可以通过以下几种方式解释：特征值分析：差分格式的系数矩阵特征值为 \(\lambda = 1 - 4r \sin^2(\frac{k\pi}{2M})\)，其中 k 是波数，M 是空间网格点数当 \(r > 0.5\) 时，某些波数的特征值会变为负数，导致数值解符号交替变化这表现为高频振荡，特别是在解的梯度较大区域放大因子分析：放大因子 \(G(k) = 1 - 4r \sin^2(\frac{k\Delta x}{2})\)当 \(r > 0.5\) 时，对于某些 k，\(|G(k)| > 1\)，导致高频分量被放大当 \(r > 1\) 时，甚至所有波数的分量都会被放大，导致完全发散能量守恒视角：热传导是能量扩散过程，应保持总能量非增当 \(r > 0.5\) 时，差分格式无法保持这种物理特性，导致能量非物理增长数值振荡的直观理解可以将数值解看作不同频率波的叠加：当 \(r \leq 0.5\) 时，所有频率分量都会被衰减，符合热传导的物理特性当 \(r > 0.5\) 时，高频分量会被放大，导致解出现振荡当 \(r > 1\) 时，所有频率分量都会被放大，导致解完全不稳定这种现象在实际计算中表现为：解在空间上出现锯齿状波动温度可能出现负值，违反物理规律边界附近振荡尤为明显随着时间推进，振荡幅度可能增大结论显式差分法在 \(r > 0.5\) 时产生数值振荡的根本原因是差分格式无法正确模拟热传导方程的能量衰减特性。当时间步长过大时，高频误差分量不仅不会被衰减，反而被放大，导致数值解出现非物理的振荡。这也是为什么在实际应用中，显式差分法通常需要很小的时间步长，以确保稳定性条件得到满足。对于需要较大时间步长的问题，通常建议使用隐式方法或半隐式方法。]

2. **如何从物理角度理解稳定性条件的含义？**
   [你的物理直觉解释
  物理角度理解显式差分法的稳定性条件显式差分法的稳定性条件（如热传导方程中的 \(r = \frac{\alpha \Delta t}{(\Delta x)^2} \leq 0.5\)）可以通过多种物理视角来直观理解，这有助于我们更好地把握数值方法与物理过程之间的内在联系。1. 热量传播速度与数值扩散物理过程：热传导是热量从高温区域向低温区域扩散的过程，其传播速度受扩散系数 \(\alpha\) 控制。在物理世界中，热量传播是连续且有限的。数值模拟：显式差分法通过离散网格点之间的热量交换来模拟这一过程每个时间步长 \(\Delta t\) 内，热量只能从一个网格点传递到相邻网格点稳定性条件 \(r \leq 0.5\) 确保了数值扩散速度不超过物理扩散速度物理解释：当 \(r > 0.5\) 时，数值方法在一个时间步内允许过多热量从一个点传递到相邻点，导致热量传播速度超过物理允许的范围，产生非物理的振荡。2. 因果关系与信息传递物理因果性：在物理系统中，某点的状态变化只能影响其有限邻域内的点，且这种影响需要时间。这体现了物理世界的因果关系。数值因果性：在显式差分法中，时间步长 \(\Delta t\) 内，信息最多只能传播一个空间步长 \(\Delta x\)稳定性条件确保了数值方法能够正确捕捉这种因果关系物理解释：当 \(r > 0.5\) 时，数值解允许信息在一个时间步内传播过远，违反了物理因果性，导致解的不稳定性。3. 能量守恒与熵增原理物理约束：热传导过程遵循能量守恒定律热力学第二定律要求熵（无序度）不减少，即热量总是从高温流向低温数值约束：稳定性条件确保差分格式能够保持这些物理约束当 \(r \leq 0.5\) 时，差分格式保证总能量不增加，且热量流动方向正确物理解释：当 \(r > 0.5\) 时，差分格式可能允许热量从低温流向高温（违反热力学第二定律），或者导致总能量非物理增长，从而破坏解的稳定性。4. 类比：抛射体运动的时间步长限制可以通过一个更直观的类比来理解：假设我们模拟一个自由落体的物体：如果时间步长过大，物体可能 "穿过" 地面而不反弹同样，当 \(r > 0.5\) 时，显式差分法在模拟热传导时会 "穿过" 物理约束，导致非物理的结果5. 扩散长度与网格尺度的匹配物理扩散长度：在时间 \(\Delta t\) 内，热量扩散的特征长度为 \(\sqrt{\alpha \Delta t}\)数值匹配条件：稳定性条件 \(r \leq 0.5\) 等价于 \(\sqrt{\alpha \Delta t} \leq \frac{\Delta x}{\sqrt{2}}\)这要求在一个时间步内，热量扩散的距离不超过网格尺度的一定比例物理解释：当 \(r > 0.5\) 时，数值扩散长度超过网格尺度，导致信息在网格间过度传播，破坏解的稳定性。结论显式差分法的稳定性条件本质上是数值方法与物理过程之间的一种 "匹配条件"：它确保数值模拟的热量传播速度不超过物理允许的速度保证数值方法能够正确捕捉物理因果关系维持能量守恒和热力学第二定律等物理约束确保扩散长度与网格尺度合理匹配从物理角度理解稳定性条件，有助于我们在实际应用中选择合适的时间步长和空间步长，同时也能更深刻地认识数值方法的局限性和适用范围。 ]
